# 要件定義書

## プロジェクト概要
ユーザーが自身の自宅の消耗品の在庫をカテゴリ別に管理できるAPI。
ユーザーはカテゴリの追加やアイテムの追加が可能

## 機能要件
### ユーザー認証・データ初期化関連
- Firebase Authenticationによるログイン認証
  - 条件
    - フロント側で初回ログイン時に GET /register_user を叩くこと(2 回目以降は不要)。
    - ログイン認証の詳しい流れはシーケンス図を要確認。

- 初回アクセス時のデフォルトデータ作成
  - 条件
    - 初回ログイン時に実行
    - デフォルトのカテゴリとそれに紐づくアイテムを自動で作成
    - 自動作成されたカテゴリ・アイテムの各データはユーザーと紐付けられ、認証完了後は自由に編集・削除が可能
    - 作成される各データのレコードのdeletedフラグは全てfalse

### カテゴリ管理機能
- カテゴリ一覧の取得
  - 条件
    - ログインユーザーが作成したデータのみ取得する
    - deletedフラグがfalseのレコードのみを対象とする
    - 更新日が新しい順に表示する
      - > 辞書順、昇順降順の切り替え（優先度低）
- カテゴリの新規作成
  - 条件
    - カテゴリ名は必須(nullチェック)
    - ログインユーザーに紐づくカテゴリ内に、同じ名前のカテゴリが存在しない
- カテゴリの編集
  - 条件
    - 編集対象はログインユーザーが作成したカテゴリのみ
    - カテゴリ名は必須（nullチェック）
    - ログインユーザーに紐づくカテゴリ内に、変更後のカテゴリ名と同じ名前のカテゴリが存在しない
- カテゴリの削除
  - 条件
    - 削除対象はログインユーザーが作成したカテゴリのみ
    - categoriesテーブルの該当レコードを論理削除（deletedフラグをtrueに更新）
    - 削除したカテゴリに紐づくitemsテーブルの全レコードも合わせて論理削除（カスケード削除）

### アイテム管理機能
- 特定のカテゴリに属するアイテム一覧の取得
  - 条件
    - カテゴリIDに紐づくアイテムを取得
    - ログインユーザーが作成したデータのみ取得する
    - deletedフラグがfalseのレコードのみを対象とする
    - 更新日が新しい順に表示する
        - > 辞書順、昇順降順の切り替え（優先度低）
    - > ページネーションの実装（優先度低）
- アイテムをカテゴリに紐づけて新規作成
  - 条件
    - アイテム名は必須（nullチェック）
    - ログインユーザーに紐づく同一カテゴリ内に同じ名前のアイテムが存在しない
    - 数量（quantity）を指定しない場合はデフォルト値として0を登録
    - カテゴリの選択必須
    - 選択できるカテゴリはログインユーザーが作成したカテゴリであること
- アイテム情報（名前、在庫数）の更新
  - 条件
    - 編集対象はログインユーザーが作成したアイテムのみ
    - アイテム名は必須（nullチェック）
    - ログインユーザーに紐づく同一カテゴリ内のアイテムに、変更後のアイテムと同じ名前のアイテムが存在しない
    - 数量（quantity）が0以上の整数であること
- アイテムの削除
  - 条件
    - 削除対象はログインユーザーが作成したアイテムのみ
    - itemsテーブルの該当レコードを論理削除（deletedフラグをtrueに更新）


## 非機能要件
- GitHub によるプロジェクト管理
- プルリクエストベースの開発フローを採用
- Spring Boot(Java)による REST API の設計・実装
- Swagger による API 仕様書の自動生成
- JUnit、Mockito を用いたユニットテストの作成
- Postman による API の動作確認
- Firebase Authentication による API 認証の実装
- DB は H2 を使用
- ビルドツールは Gradle を使用

## 作業スケジュール（予定）
- 設計書作成（5日間：7/16-18、22-23）
  - 要件定義書
  - ER図
  - API仕様書
  - DTO, Entity定義書
  - シーケンス図
- 環境構築（2日間：7/24-25）
- 実装（3日間：7/28-30）
- テスト（2日間：7/31-8/1）
